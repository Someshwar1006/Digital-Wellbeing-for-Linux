# Post-installation script for ZenScreen

post_install() {
    echo ""
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                                                               â•‘"
    echo "â•‘   ðŸ§˜  ZenScreen - Digital Wellbeing for Linux                 â•‘"
    echo "â•‘                                                               â•‘"
    echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
    echo "â•‘                                                               â•‘"
    echo "â•‘   Thank you for installing ZenScreen!                         â•‘"
    echo "â•‘                                                               â•‘"
    echo "â•‘   Quick Start:                                                â•‘"
    echo "â•‘                                                               â•‘"
    echo "â•‘   â€¢ Launch GUI:       zenscreen-gtk                           â•‘"
    echo "â•‘   â€¢ View status:      zenscreen status                        â•‘"
    echo "â•‘   â€¢ Start focus:      zenscreen focus start                   â•‘"
    echo "â•‘   â€¢ View reports:     zenscreen report --week                 â•‘"
    echo "â•‘                                                               â•‘"
    echo "â•‘   Enable auto-start tracking:                                 â•‘"
    echo "â•‘   $ systemctl --user enable --now zenscreen.service           â•‘"
    echo "â•‘                                                               â•‘"
    echo "â•‘   Documentation: zenscreen --help                             â•‘"
    echo "â•‘                                                               â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    
    # Update icon cache
    if [ -x /usr/bin/gtk-update-icon-cache ]; then
        gtk-update-icon-cache -q -t -f /usr/share/icons/hicolor
    fi
    
    # Update desktop database
    if [ -x /usr/bin/update-desktop-database ]; then
        update-desktop-database -q /usr/share/applications
    fi
}

post_upgrade() {
    echo ""
    echo "ðŸ§˜ ZenScreen has been upgraded to version $1"
    echo ""
    echo "If you're running the daemon, restart it:"
    echo "  $ systemctl --user restart zenscreen.service"
    echo ""
    
    # Update icon cache
    if [ -x /usr/bin/gtk-update-icon-cache ]; then
        gtk-update-icon-cache -q -t -f /usr/share/icons/hicolor
    fi
    
    # Update desktop database
    if [ -x /usr/bin/update-desktop-database ]; then
        update-desktop-database -q /usr/share/applications
    fi
}

pre_remove() {
    # Stop the service if running
    if systemctl --user is-active --quiet zenscreen.service 2>/dev/null; then
        systemctl --user stop zenscreen.service
    fi
    
    # Disable the service
    if systemctl --user is-enabled --quiet zenscreen.service 2>/dev/null; then
        systemctl --user disable zenscreen.service
    fi
}

post_remove() {
    echo ""
    echo "ðŸ§˜ ZenScreen has been removed."
    echo ""
    echo "Your usage data is preserved in:"
    echo "  ~/.local/share/zenscreen/"
    echo ""
    echo "To completely remove all data:"
    echo "  $ rm -rf ~/.local/share/zenscreen/"
    echo ""
    
    # Update icon cache
    if [ -x /usr/bin/gtk-update-icon-cache ]; then
        gtk-update-icon-cache -q -t -f /usr/share/icons/hicolor
    fi
    
    # Update desktop database
    if [ -x /usr/bin/update-desktop-database ]; then
        update-desktop-database -q /usr/share/applications
    fi
}
